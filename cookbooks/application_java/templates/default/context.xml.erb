<Context docBase="<%= @war %>" path="/"
        debug="5" reloadable="true" crossContext="true" allowLinking="true">
  <Environment name="appEnvironment" value="<%= node.chef_environment %>"
          type="java.lang.String" override="false"/>

  <% @database['datasource'].each do |datasource| -%>  
    <Resource name="<%= datasource %>" auth="Container" type="javax.sql.DataSource"
              maxActive="<%= @database['max_active'] %>" maxIdle="<%= @database['max_idle'] %>" maxWait="<%= @database['max_wait'] %>" validationQuery="select 1"
              username="<%= @database['username'] %>" password="<%= @database['password'] %>" driverClassName="<%= @database['driver'] %>"
              url="jdbc:<%= @database['adapter'] %>://<%= @host %>:<%= @database['port'] %>/<%= @database['database'] %>"/>
  <% end -%>
</Context>
